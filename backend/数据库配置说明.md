# 数据库配置说明

## 问题：Unknown dialect better-sqlite3

Strapi 4 不支持 `better-sqlite3`，需要使用 `sqlite` 或 `postgres`。

## 解决方案

### 方案一：使用 PostgreSQL（推荐）

PostgreSQL 是 Strapi 推荐的生产数据库，安装简单且稳定。

#### 1. 安装 PostgreSQL

**macOS:**
```bash
brew install postgresql@14
brew services start postgresql@14
```

**创建数据库:**
```bash
createdb strapi_dev
```

#### 2. 配置 .env 文件

在 `backend/.env` 中添加：
```env
DATABASE_URL=postgresql://localhost:5432/strapi_dev
```

#### 3. 启动 Strapi

```bash
npm run develop
```

### 方案二：使用 SQLite（开发环境）

如果使用 SQLite，需要安装 `sqlite3` 包：

```bash
npm install sqlite3 --save
```

**注意：** `sqlite3` 需要编译原生模块，可能需要：
- Python 2.7 或 3.x（但 Python 3.13+ 可能缺少 distutils）
- 编译工具（Xcode Command Line Tools on macOS）

如果安装失败，建议使用 PostgreSQL。

### 方案三：使用 Docker（最简单）

使用 Docker 运行 PostgreSQL，无需本地安装：

```bash
# 启动 PostgreSQL 容器
docker run --name strapi-postgres \
  -e POSTGRES_PASSWORD=strapi \
  -e POSTGRES_DB=strapi_dev \
  -p 5432:5432 \
  -d postgres:14

# 在 .env 中配置
DATABASE_URL=postgresql://postgres:strapi@localhost:5432/strapi_dev
```

## 当前配置

当前配置支持两种数据库：

1. **PostgreSQL**：如果设置了 `DATABASE_URL` 环境变量
2. **SQLite**：默认使用（需要安装 sqlite3）

## 推荐配置

对于开发环境，推荐使用 PostgreSQL + Docker，最简单且稳定。

